program test;

{$APPTYPE CONSOLE}

uses
  SysUtils;

type TPnodo = ^ Tnodo;
     subtrie = record
                letra:char;
                hijos:TPnodo ;
                end;
     Tnodo = record
               IsEndOfWord :boolean;
               hijo:subtrie;
            end;
var palabra: string;



procedure insertarPalabra(p:string; raiz:TPnodo);
var i,j,k:integer;
    nuevoNodo,inicial: TPnodo;


begin
inicial:=raiz;
j:=length(p);

if raiz^.hijo.hijos = nil then
begin
    {Caso que el arbol este vacio}
    for i:=1 to j do
    begin
       //crea el nuevo nodo
       new(nuevoNodo);
       nuevoNodo^.hijo.hijos:=nil;
       nuevoNodo^.hijo.letra:=p[i];
       //lo conecta
       raiz^.hijo.hijos:=nuevoNodo;
       raiz:=raiz^.hijo.hijos;
       write(raiz^.hijo.letra);
    end;
    raiz^.IsEndOfWord:=true;
    writeln('');
    writeln('FDP:',raiz^.IsEndOfWord,' ',raiz^.hijo.letra);
    raiz:=inicial;
    writeln('FDP:',raiz^.IsEndOfWord,' ',raiz^.hijo.hijos^.hijo.letra);
end
else
    {ya tenga palabras}
    begin
        for i:=1 to j do
        begin
            if (raiz^.hijo.letra = p[i]) and (raiz^.hijo.hijos <> nil)  then
                raiz:=raiz^.hijo.hijos
            else
                begin
                    //crea el nuevo nodo
                    new(nuevoNodo);
                    nuevoNodo^.hijo.hijos:=nil;
                    nuevoNodo^.hijo.letra:=p[i];
                    //lo conecta
                    raiz^.hijo.hijos:=nuevoNodo;
                    raiz:=raiz^.hijo.hijos;
                    write(raiz^.hijo.letra);
                end;

    end;
    raiz^.IsEndOfWord:=true;
    writeln('');
    writeln('FDP:',raiz^.IsEndOfWord,' ',raiz^.hijo.letra);
    raiz:=inicial;
    writeln('FDP:',raiz^.IsEndOfWord,' ',raiz^.hijo.hijos^.hijo.letra);
end;
end;

procedure printTrie(espacio:integer;raiz:TPnodo);
begin
    while raiz^.hijo.hijos <> nil do
    begin
        if raiz^.isendofword = true then
        begin
            write(raiz^.hijo.hijos^.hijo.letra);
            raiz:= raiz^.hijo.hijos;
        end
        else
            begin
                write(raiz^.hijo.hijos^.hijo.letra);
                raiz:= raiz^.hijo.hijos;
            end;

    end;

end;

//--------------------programa ppal-----------------------

var raiz:tpnodo;
    p,h,i,j,k,l,m,n:string;
begin
  { TODO -oUser -cConsole Main : Insert code here }

new(raiz);
p:='perro';
insertarPalabra(p, raiz);
writeln('--------------------------------');
h:='pera';
insertarPalabra(h, raiz);
writeln('--------------------------------');
i:='perenne';
insertarPalabra(i, raiz);
{writeln('--------------------------------');
j:='arbol';
insertarPalabra(j, raiz);
writeln('--------------------------------');
k:='arboleda';
insertarPalabra(k, raiz);
writeln('--------------------------------');
l:='12345';
insertarPalabra(l,raiz);
writeln('--------------------------------');
m:='1233';
insertarPalabra(m,raiz);
writeln('--------------------------------');
n:='1533';
insertarPalabra(n,raiz); }
writeln('--------------------------------');

printTrie(1,raiz);




readln;

end.
